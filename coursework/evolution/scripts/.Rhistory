birth,
sex,
educ
) %>%
mutate(
years_old = trunc(as.numeric(Sys.Date() - birth)/365),
sex = if_else(sex == "Femenino", "F", "M")
)
demographics
summary(demographics$years_old)
nrow(demographics)
table(demographics$sex)
table(demographics$educ)
unique(data$`Confío en las tendencias de largo plazo mas que en los eventos recientes para tomar decisiones`)
unique(data$`Valora lo artístico, lo estético`)
likert_levels <- c(
"Totalmente en desacuerd",
"En desacuerdo", "Neutral", "De acuerdo", "Totalmente de acuerdo"
)
colnames(data)
survey_data <- data %>%
select(-c(id, timestamp, brith, sex, educ))
survey_data <- data %>%
select(-c(id, timestamp, birth, sex, educ))
survey_data
survey_data <- data %>%
select(-c(id, timestamp, birth, sex, educ)) %>%
mutate(across(everything(), ~ factor(., levels = likert_levels)))
survey_data
pacman::p_load(
tidyverse,
psych,
likert
)
likert_results <- likert(survey_data)
surver_data
survey_data
survey_data %>%
pivot_longer(
cols = everything()
)
survey_data %>%
pivot_longer(
cols = everything()
) %>% view
survey_data %>%
pivot_longer(
cols = everything()
) %>%
ggplot(aes(value)) +
geom_histogram() +
facet_wrap(~name)
survey_data %>%
pivot_longer(
cols = everything()
) %>%
group_by(name, value) %>%
summarise(
cnt = n()
)
survey_data %>%
pivot_longer(
cols = everything()
) %>%
mutate(
item = row_number()
) %>%
group_by(item, value) %>%
summarise(
cnt = n()
)
survey_data %>%
pivot_longer(
cols = everything()
) %>%
mutate(
item = row_number()
) %>%
group_by(item, value) %>%
summarise(
cnt = n()
) %>% view
survey_data %>%
pivot_longer(
cols = everything()
) %>%
group_by(name, value) %>%
summarise(
cnt = n()
)
survey_data %>%
pivot_longer(
cols = everything()
) %>%
group_by(name, value) %>%
summarise(
cnt = n()
) %>%
ggplot(aes(
cnt
)) +
geom_histogram() +
facet_wrap(~name)
survey_data %>%
pivot_longer(
cols = everything()
) %>%
group_by(name, value) %>%
summarise(
cnt = n()
) %>%
ggplot(aes(
value, cnt
)) +
geom_col() +
facet_wrap(~name)
survey_data %>%
pivot_longer(
cols = everything()
) %>%
group_by(name, value) %>%
summarise(
cnt = n()
) %>%
mutate(
item = data.table::rleid(name)
)
survey_data %>%
pivot_longer(
cols = everything()
) %>%
group_by(name, value) %>%
summarise(
cnt = n()
) %>%
ungroup() %>%
mutate(
item = data.table::rleid(name)
)
survey_data %>%
pivot_longer(
cols = everything()
) %>%
group_by(name, value) %>%
summarise(
cnt = n()
) %>%
ungroup() %>%
mutate(
item = data.table::rleid(name)
) %>%
ggplot(aes(
value, cnt
)) +
geom_col() +
facet_wrap(~item)
survey_data %>%
pivot_longer(
cols = everything()
) %>%
group_by(name, value) %>%
summarise(
cnt = n()
) %>%
ungroup() %>%
mutate(
item = data.table::rleid(name)
) %>%
ggplot(aes(
value, cnt
)) +
geom_col() +
facet_wrap(~item) +
scale_x_discrete(breaks = c(1:5))
survey_data %>%
pivot_longer(
cols = everything()
) %>%
group_by(name, value) %>%
summarise(
cnt = n()
) %>%
ungroup() %>%
mutate(
item = data.table::rleid(name)
) %>%
ggplot(aes(
value, cnt
)) +
geom_col() +
facet_wrap(~item)
survey_data %>%
pivot_longer(
cols = everything()
) %>%
group_by(name, value) %>%
summarise(
cnt = n()
) %>%
ungroup() %>%
mutate(
item = data.table::rleid(name)
) %>%
ggplot(aes(
value, cnt
)) +
geom_col() +
scale_x_discrete(labels = c("a")) +
facet_wrap(~item)
survey_data %>%
pivot_longer(
cols = everything()
) %>%
group_by(name, value) %>%
summarise(
cnt = n()
) %>%
ungroup() %>%
mutate(
item = data.table::rleid(name)
) %>%
ggplot(aes(
value, cnt
)) +
geom_col() +
scale_x_discrete(labels = c("TD", "D", "N", "A", "TA")) +
facet_wrap(~item)
pacman::p_load(
tidyverse,
psych,
likert,
ggthemes
)
survey_data %>%
pivot_longer(
cols = everything()
) %>%
group_by(name, value) %>%
summarise(
cnt = n()
) %>%
ungroup() %>%
mutate(
item = data.table::rleid(name)
) %>%
ggplot(aes(
value, cnt
)) +
geom_col() +
scale_x_discrete(labels = c("TD", "D", "N", "A", "TA")) +
theme_par() +
facet_wrap(~item)
survey_data %>%
pivot_longer(
cols = everything()
) %>%
group_by(name, value) %>%
summarise(
cnt = n()
) %>%
ungroup() %>%
mutate(
item = data.table::rleid(name)
) %>%
ggplot(aes(
value, cnt
)) +
geom_col() +
scale_x_discrete(labels = c("TD", "D", "N", "A", "TA")) +
theme_par() +
ylab("Frecuencia") +
xlab("") +
facet_wrap(~item)
survey_data %>%
pivot_longer(
cols = everything()
) %>%
group_by(name, value) %>%
summarise(
cnt = n()
) %>%
ungroup() %>%
mutate(
item = data.table::rleid(name)
) %>%
ggplot(aes(
value, cnt
)) +
geom_col() +
scale_y_continuous(breaks = seq(0, 20, 10)) +
scale_x_discrete(labels = c("TD", "D", "N", "A", "TA")) +
theme_par() +
ylab("Frecuencia") +
xlab("") +
facet_wrap(~item)
fac_an <- data[, 5:11]
fac_an_num <- fac_an %>%
mutate(
across(everything(), as.numeric)
)
alpha_data <- alpha(fac_an_num, check.keys = TRUE)
alpha_data
fac_an
pacman::p_load(
tidyverse
)
setwd(this.path::here())
# load data ----
rating <- read_csv("../data/inter_rater.csv")
# agreement metric
discrepancy_mat <- rating %>%
rowwise() %>%
mutate(
max_sd = sd(c(4, 1)),
std_dev = sd(c(rater1, rater2)),
mean_score = mean(c(rater1, rater2))
) %>%
ungroup() %>%
mutate(
agreement = (1 - (std_dev / max_sd))
)
discrepancy_mat
# mean agreement per item
mean_agreement <- discrepancy_mat %>%
ungroup() %>%
group_by(item) %>%
summarise(
mean_agreement = mean(agreement),
mean_score = mean(mean_score)
) %>%
mutate(
dimension = if_else(item <= 10, "belief", "stochasticity")
) %>%
filter(
mean_agreement >= 0.8
)
mean_agreement
fac_an <- data[, 5:11]
fac_an_num <- fac_an %>%
mutate(
across(everything(), as.numeric)
)
fac_an_num
alpha_data_belieft <- alpha(fac_an_num[1, 4], check.keys = TRUE)
alpha_data_belieft <- alpha(fac_an_num[,1:4], check.keys = TRUE)
alpha_data
alpha_data
fac_an_num[,1:4]
fac_an_num
alpha_data
alpha_data_belief
alpha_data_belief <- alpha(fac_an_num[,1:4], check.keys = TRUE)
alpha_data_belief
alpha_data_estoc <- alpha(fac_an_num[, 5:7], check.keys = TRUE)
alpha_data_estoc
parallel_result <- fa.parallel(fac_an_num, fm = "ml", fa = "fa", n.iter = 1000)
num_factors <- parallel_result$nfact
efa_result <- fa(fac_an_num, nfactors = num_factors, rotate = "varimax")
parallel_result
cor.plot(fac_an_num)
cor.plot(fac_an_num)
cor(fac_an_num)
cor(fac_an_num) %>% mean
cor(fac_an_num) %>% as.vector
parallel_result
cor.plot(fac_an_num, numbers = TRUE, upper = FALSE)
cortest.bartlett(fac_an_num)
KMO(fac_an_num)
data
View(data)
# factorial analysis ----
big_five <- data[,12:]
data
# factorial analysis ----
big_five <- data[,12:31]
big_five
big_five %>% view
# factorial analysis ----
big_five <- data[,12:30]
colnames(big_five)
# correlations
data[, 1:4] %>% colnames
# correlations
data[, 5:8] %>% colnames
# correlations
data[, 12:30] %>% colnames
colnames(data[, 12:22])
colnames(data[, 12:21])
colnames(data[, 22:30])
keys.list <- list(
alpha = c(colnames(data[, 5:8])),
temperature = c(colnames(data[, 9:11])),
Openness = c(colnames(data[, 12:21])),
Conscientiousness = c(colnames(data[, 22:30]))
)
keys.list
keys.list <- list(
alpha = c(colnames(data[, 5:8])),
temperature = c(colnames(data[, 9:11])),
Openness = c("Es inventivo", "Es original, se le ocurren ideas nuevas", "Valora lo artístico, lo estético", "Tiene una imaginación activa", "Le gusta reflexionar, jugar con las ideas", "Es educado en arte, música, o literatura", "En ingenioso, analítico", "Tiene intereses muy diversos", "-Prefiere trabajos que son rutinarios", "-Tiene poco intereses artísticos"),
Conscientiousness = c("Es minucioso en el trabajo", "Hace las cosas de manera eficiente", "Hace planes y los sigue cuidadosamente", "Es un trabajador cumplidor, de confianza", "Persevera hasta terminar el trabajo", "-Se distrae con facilidad", "-Puede a veces ser algo descuidado", "-Tiende a ser flojo, vago", "-Tiende a ser desorganizado")
)
keys.list
scale_scores <- scoreItems(keys.list, data)
keys.list <- list(
alpha = c(colnames(data[, 5:8])),
temperature = c(colnames(data[, 9:11])),
Openness = c(colnames(data[, 12:21])),
Conscientiousness = c(colnames(data[, 22:30]))
)
scale_scores <- scoreItems(keys.list, data)
keys.list <- list(
alpha = c(colnames(data[, 5:8])),
temperature = c(colnames(data[, 9:11])),
Openness = c(colnames(data[, 12:21])),
Conscientiousness = c(colnames(data[, 22:30]))
)
scale_scores <- scoreItems(keys.list, data)
colnames(data[, 22:30]
)
# correlations
data_num <- data %>%
mutate(
across(everything(), as.numeric)
)
data_num
keys.list <- list(
alpha = c(colnames(data[, 5:8])),
temperature = c(colnames(data[, 9:11])),
Openness = c(colnames(data[, 12:21])),
Conscientiousness = c(colnames(data[, 22:30]))
)
scale_scores <- scoreItems(keys.list, data)
keys.list <- list(
alpha = c(colnames(data_num[, 5:8])),
temperature = c(colnames(data_num[, 9:11])),
Openness = c("Es inventivo", "Es original, se le ocurren ideas nuevas", "Valora lo artístico, lo estético", "Tiene una imaginación activa", "Le gusta reflexionar, jugar con las ideas", "Es educado en arte, música, o literatura", "En ingenioso, analítico", "Tiene intereses muy diversos", "-Prefiere trabajos que son rutinarios", "-Tiene poco intereses artísticos"),
Conscientiousness = c("Es minucioso en el trabajo", "Hace las cosas de manera eficiente", "Hace planes y los sigue cuidadosamente", "Es un trabajador cumplidor, de confianza", "Persevera hasta terminar el trabajo", "-Se distrae con facilidad", "-Puede a veces ser algo descuidado", "-Tiende a ser flojo, vago", "-Tiende a ser desorganizado")
)
scale_scores <- scoreItems(keys.list, data)
scale_scores <- scoreItems(keys.list, data_num)
scale_scores
final_scores_df <- as.data.frame(scale_scores$scores)
final_scores_df
correlation_matrix <- corr.test(final_scores_df)
correlation_matrix
final_scores_df
final_scores_df <- as_tibble(scale_scores$scores)
final_scores_df
final_scores_df <- as_tibble(scale_scores$scores) %>%
rename(
Stability = alpha,
Estochasticity = temperature
)
correlation_matrix <- corr.test(final_scores_df)
corrplot::corrplot(correlation_matrix)
corrplot::corrplot(correlation_matrix$r)
corrplot::corrplot(correlation_matrix$r,
lower = FALSE)
?corrplot
corrplot::corrplot(correlation_matrix$r,
type = "upper",
method = "square")
corrplot::corrplot(correlation_matrix$r,
type = "upper",
method = "square",
numbers = TRUE)
corrplot::corrplot(correlation_matrix$r,
p.mat = correlation_matrix$p.adj,
type = "upper",
method = "square",
numbers = TRUE)
corrplot::corrplot(correlation_matrix$r,
p.mat = correlation_matrix$p.adj,
type = "upper",
method = "square")
corrplot::corrplot(correlation_matrix$r,
p.mat = correlation_matrix$p.adj,
type = "upper",
method = "square")
correlation_matrix$p.adj
correlation_matrix$p
corrplot::corrplot(correlation_matrix$r,
p.mat = correlation_matrix$p,
type = "upper",
method = "square")
corrplot::corrplot(correlation_matrix$r,
p.mat = correlation_matrix$p,
type = "circle",
method = "square")
corrplot::corrplot(correlation_matrix$r,
p.mat = correlation_matrix$p,
method = "square")
corrplot::corrplot(correlation_matrix$r,
p.mat = correlation_matrix$p,
type = "upper",
method = "circle")
corrplot::corrplot(correlation_matrix$r,
p.mat = correlation_matrix$p,
type = "upper",
method = "number")
final_scores_df <- as_tibble(scale_scores$scores) %>%
rename(
Stability = alpha,
Stochasticity = temperature
)
correlation_matrix <- corr.test(final_scores_df)
corrplot::corrplot(correlation_matrix$r,
p.mat = correlation_matrix$p,
type = "upper",
method = "number")
correlation_matrix
